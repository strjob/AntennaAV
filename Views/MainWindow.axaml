<Window
    x:Class="AntennaAV.Views.MainWindow"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ScottPlot="clr-namespace:ScottPlot.Avalonia;assembly=ScottPlot.Avalonia"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:AntennaAV"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:treegrid="clr-namespace:Avalonia.Controls;assembly=Avalonia.Controls.TreeDataGrid"
    xmlns:vm="using:AntennaAV.ViewModels"
    Title="AntennaAV"
    d:DesignHeight="720"
    d:DesignWidth="1366"
    x:DataType="vm:MainWindowViewModel"
    Icon="/Assets/avalonia-logo.ico"
    mc:Ignorable="d">

    <Window.Resources>
        <local:HexToColorConverter x:Key="HexToColorConverter" />
    </Window.Resources>

    <Window.Resources>
        <StreamGeometry x:Key="save_as_regular">M5.75 3C4.23122 3 3 4.23122 3 5.75V18.25C3 19.7688 4.23122 21 5.75 21H9.99852C9.99129 20.8075 10.011 20.6088 10.0613 20.4075L10.2882 19.5H7.5V14.25C7.5 13.8358 7.83579 13.5 8.25 13.5H14.8531L16.2883 12.0648C16.1158 12.0225 15.9355 12 15.75 12H8.25C7.00736 12 6 13.0074 6 14.25V19.5H5.75C5.05964 19.5 4.5 18.9404 4.5 18.25V5.75C4.5 5.05964 5.05964 4.5 5.75 4.5H7V7.25C7 8.49264 8.00736 9.5 9.25 9.5H13.75C14.9926 9.5 16 8.49264 16 7.25V4.52344C16.3582 4.58269 16.6918 4.75246 16.9519 5.01256L18.9874 7.0481C19.3156 7.37629 19.5 7.8214 19.5 8.28553V10.007C19.5709 10.0024 19.642 10 19.713 10H19.7151C20.1521 10.0002 20.59 10.0874 21 10.2615V8.28553C21 7.42358 20.6576 6.59693 20.0481 5.98744L18.0126 3.9519C17.4031 3.34241 16.5764 3 15.7145 3H5.75ZM8.5 7.25V4.5H14.5V7.25C14.5 7.66421 14.1642 8 13.75 8H9.25C8.83579 8 8.5 7.66421 8.5 7.25Z M19.7152 11H19.7131C19.1285 11.0003 18.5439 11.2234 18.0979 11.6695L12.1955 17.5719C11.8513 17.916 11.6072 18.3472 11.4892 18.8194L11.0315 20.6501C10.8325 21.4462 11.5536 22.1674 12.3497 21.9683L14.1804 21.5106C14.6526 21.3926 15.0838 21.1485 15.4279 20.8043L21.3303 14.9019C22.223 14.0093 22.223 12.5621 21.3303 11.6695C20.8843 11.2234 20.2998 11.0003 19.7152 11Z</StreamGeometry>
        <StreamGeometry x:Key="delete_forever_regular">M19.5,16 C22.5375661,16 25,18.4624339 25,21.5 C25,24.5375661 22.5375661,27 19.5,27 C16.4624339,27 14,24.5375661 14,21.5 C14,18.4624339 16.4624339,16 19.5,16 Z M14,2.25 C16.0042592,2.25 17.6412737,3.82236105 17.744802,5.80084143 L17.75,6 L23.25,6 C23.6642136,6 24,6.33578644 24,6.75 C24,7.12969577 23.7178461,7.44349096 23.3517706,7.49315338 L23.25,7.5 L22.191,7.5 L21.5567191,15.3321126 C21.0850145,15.1748937 20.5892627,15.0702731 20.0764221,15.0252089 L20.6867279,7.5 L7.31327208,7.5 L8.52396146,22.4318357 C8.6186884,23.6001347 9.59446882,24.5 10.7666018,24.5 L13.7327703,24.5010736 C14.0200482,25.0520148 14.3839565,25.5566422 14.8103588,26.0008195 L10.7666018,26 C8.81304683,26 7.18674613,24.5002245 7.02886788,22.5530595 L5.808,7.5 L4.75,7.5 C4.37030423,7.5 4.05650904,7.21784612 4.00684662,6.85177056 L4,6.75 C4,6.37030423 4.28215388,6.05650904 4.64822944,6.00684662 L4.75,6 L10.25,6 C10.25,3.92893219 11.9289322,2.25 14,2.25 Z M17.0237993,19.0241379 C16.8285371,19.2194 16.8285371,19.5359825 17.0237993,19.7312446 L18.793,21.501 L17.0263884,23.2674911 C16.8311263,23.4627532 16.8311263,23.7793357 17.0263884,23.9745978 C17.2216505,24.16986 17.538233,24.16986 17.7334952,23.9745978 L19.5,22.208 L21.2693951,23.9768405 C21.4646573,24.1721026 21.7812398,24.1721026 21.9765019,23.9768405 C22.1717641,23.7815783 22.1717641,23.4649959 21.9765019,23.2697337 L20.208,21.501 L21.9792686,19.7312918 C22.1745308,19.5360297 22.1745308,19.2194472 21.9792686,19.024185 C21.7840065,18.8289229 21.467424,18.8289229 21.2721619,19.024185 L19.501,20.794 L17.7309061,19.0241379 C17.5356439,18.8288757 17.2190614,18.8288757 17.0237993,19.0241379 Z M14,3.75 C12.809136,3.75 11.8343551,4.67516159 11.7551908,5.84595119 L11.75,6 L16.25,6 L16.2448092,5.84595119 C16.1656449,4.67516159 15.190864,3.75 14,3.75 Z</StreamGeometry>
        <StreamGeometry x:Key="eye_show_regular">M12,9.0046246 C14.209139,9.0046246 16,10.7954856 16,13.0046246 C16,15.2137636 14.209139,17.0046246 12,17.0046246 C9.790861,17.0046246 8,15.2137636 8,13.0046246 C8,10.7954856 9.790861,9.0046246 12,9.0046246 Z M12,10.5046246 C10.6192881,10.5046246 9.5,11.6239127 9.5,13.0046246 C9.5,14.3853365 10.6192881,15.5046246 12,15.5046246 C13.3807119,15.5046246 14.5,14.3853365 14.5,13.0046246 C14.5,11.6239127 13.3807119,10.5046246 12,10.5046246 Z M12,5.5 C16.613512,5.5 20.5960869,8.65000641 21.7011157,13.0643865 C21.8017,13.4662019 21.557504,13.8734775 21.1556885,13.9740618 C20.7538731,14.0746462 20.3465976,13.8304502 20.2460132,13.4286347 C19.3071259,9.67795854 15.9213644,7 12,7 C8.07693257,7 4.69009765,9.68026417 3.75285786,13.4331499 C3.65249525,13.8350208 3.24535455,14.0794416 2.84348365,13.979079 C2.44161275,13.8787164 2.19719198,13.4715757 2.29755459,13.0697048 C3.4006459,8.65271806 7.38448293,5.5 12,5.5 Z</StreamGeometry>
        <StreamGeometry x:Key="eye_hide_regular">M2.21967 2.21967C1.9534 2.48594 1.9292 2.9026 2.14705 3.19621L2.21967 3.28033L6.25424 7.3149C4.33225 8.66437 2.89577 10.6799 2.29888 13.0644C2.1983 13.4662 2.4425 13.8735 2.84431 13.9741C3.24613 14.0746 3.6534 13.8305 3.75399 13.4286C4.28346 11.3135 5.59112 9.53947 7.33416 8.39452L9.14379 10.2043C8.43628 10.9258 8 11.9143 8 13.0046C8 15.2138 9.79086 17.0046 12 17.0046C13.0904 17.0046 14.0788 16.5683 14.8004 15.8608L20.7197 21.7803C21.0126 22.0732 21.4874 22.0732 21.7803 21.7803C22.0466 21.5141 22.0708 21.0974 21.8529 20.8038L21.7803 20.7197L15.6668 14.6055L15.668 14.604L14.4679 13.4061L11.598 10.5368L11.6 10.536L8.71877 7.65782L8.72 7.656L7.58672 6.52549L3.28033 2.21967C2.98744 1.92678 2.51256 1.92678 2.21967 2.21967ZM10.2041 11.2655L13.7392 14.8006C13.2892 15.2364 12.6759 15.5046 12 15.5046C10.6193 15.5046 9.5 14.3853 9.5 13.0046C9.5 12.3287 9.76824 11.7154 10.2041 11.2655ZM12 5.5C10.9997 5.5 10.0291 5.64807 9.11109 5.925L10.3481 7.16119C10.8839 7.05532 11.4364 7 12 7C15.9231 7 19.3099 9.68026 20.2471 13.4332C20.3475 13.835 20.7546 14.0794 21.1565 13.9791C21.5584 13.8787 21.8028 13.4716 21.7024 13.0697C20.5994 8.65272 16.6155 5.5 12 5.5Z</StreamGeometry>
        <StreamGeometry x:Key="delete_regular">M24,7.25 C27.1017853,7.25 29.629937,9.70601719 29.7458479,12.7794443 L29.75,13 L37,13 C37.6903559,13 38.25,13.5596441 38.25,14.25 C38.25,14.8972087 37.7581253,15.4295339 37.1278052,15.4935464 L37,15.5 L35.909,15.5 L34.2058308,38.0698451 C34.0385226,40.2866784 32.1910211,42 29.9678833,42 L18.0321167,42 C15.8089789,42 13.9614774,40.2866784 13.7941692,38.0698451 L12.09,15.5 L11,15.5 C10.3527913,15.5 9.8204661,15.0081253 9.75645361,14.3778052 L9.75,14.25 C9.75,13.6027913 10.2418747,13.0704661 10.8721948,13.0064536 L11,13 L18.25,13 C18.25,9.82436269 20.8243627,7.25 24,7.25 Z M33.4021054,15.5 L14.5978946,15.5 L16.2870795,37.8817009 C16.3559711,38.7945146 17.116707,39.5 18.0321167,39.5 L29.9678833,39.5 C30.883293,39.5 31.6440289,38.7945146 31.7129205,37.8817009 L33.4021054,15.5 Z M27.25,20.75 C27.8972087,20.75 28.4295339,21.2418747 28.4935464,21.8721948 L28.5,22 L28.5,33 C28.5,33.6903559 27.9403559,34.25 27.25,34.25 C26.6027913,34.25 26.0704661,33.7581253 26.0064536,33.1278052 L26,33 L26,22 C26,21.3096441 26.5596441,20.75 27.25,20.75 Z M20.75,20.75 C21.3972087,20.75 21.9295339,21.2418747 21.9935464,21.8721948 L22,22 L22,33 C22,33.6903559 21.4403559,34.25 20.75,34.25 C20.1027913,34.25 19.5704661,33.7581253 19.5064536,33.1278052 L19.5,33 L19.5,22 C19.5,21.3096441 20.0596441,20.75 20.75,20.75 Z M24,9.75 C22.2669685,9.75 20.8507541,11.1064548 20.7551448,12.8155761 L20.75,13 L27.25,13 C27.25,11.2050746 25.7949254,9.75 24,9.75 Z</StreamGeometry>
        <StreamGeometry x:Key="erase_regular">M15.8698693,2.66881311 L20.838395,7.63733874 C21.7170746,8.5160184 21.7170746,9.9406396 20.838395,10.8193193 L12.1565953,19.4998034 L18.25448,19.5 C18.6341758,19.5 18.947971,19.7821539 18.9976334,20.1482294 L19.00448,20.25 C19.00448,20.6296958 18.7223262,20.943491 18.3562506,20.9931534 L18.25448,21 L9.84446231,21.0012505 C9.22825282,21.0348734 8.60085192,20.8163243 8.13013068,20.345603 L3.16160505,15.3770774 C2.28292539,14.4983977 2.28292539,13.0737765 3.16160505,12.1950969 L12.6878888,2.66881311 C13.5665685,1.79013346 14.9911897,1.79013346 15.8698693,2.66881311 Z M5.70859531,11.7678034 L4.22226522,13.255757 C3.929372,13.5486503 3.929372,14.023524 4.22226522,14.3164172 L9.19079085,19.2849428 C9.33723746,19.4313895 9.5291792,19.5046128 9.72112094,19.5046128 L9.75,19.5 L9.78849588,19.5015989 C9.95740385,19.4864544 10.1221581,19.4142357 10.251451,19.2849428 L11.7375953,17.7978034 L5.70859531,11.7678034 Z M13.748549,3.72947329 L6.76959531,10.7068034 L12.7985953,16.7368034 L19.7777348,9.75865909 C20.070628,9.46576587 20.070628,8.99089214 19.7777348,8.69799892 L14.8092091,3.72947329 C14.5163159,3.43658007 14.0414422,3.43658007 13.748549,3.72947329 Z</StreamGeometry>

        <StreamGeometry x:Key="add_square_regular">M12 7C12.4142 7 12.75 7.33579 12.75 7.75V11.25H16.25C16.6642 11.25 17 11.5858 17 12C17 12.4142 16.6642 12.75 16.25 12.75H12.75V16.25C12.75 16.6642 12.4142 17 12 17C11.5858 17 11.25 16.6642 11.25 16.25V12.75H7.75C7.33579 12.75 7 12.4142 7 12C7 11.5858 7.33579 11.25 7.75 11.25H11.25V7.75C11.25 7.33579 11.5858 7 12 7Z M3 6.25C3 4.45507 4.45507 3 6.25 3H17.75C19.5449 3 21 4.45507 21 6.25V17.75C21 19.5449 19.5449 21 17.75 21H6.25C4.45507 21 3 19.5449 3 17.75V6.25ZM6.25 4.5C5.2835 4.5 4.5 5.2835 4.5 6.25V17.75C4.5 18.7165 5.2835 19.5 6.25 19.5H17.75C18.7165 19.5 19.5 18.7165 19.5 17.75V6.25C19.5 5.2835 18.7165 4.5 17.75 4.5H6.25Z</StreamGeometry>
        <StreamGeometry x:Key="folder_open_regular">M12 7C12.4142 7 12.75 7.33579 12.75 7.75V11.25H16.25C16.6642 11.25 17 11.5858 17 12C17 12.4142 16.6642 12.75 16.25 12.75H12.75V16.25C12.75 16.6642 12.4142 17 12 17C11.5858 17 11.25 16.6642 11.25 16.25V12.75H7.75C7.33579 12.75 7 12.4142 7 12C7 11.5858 7.33579 11.25 7.75 11.25H11.25V7.75C11.25 7.33579 11.5858 7 12 7Z M3 6.25C3 4.45507 4.45507 3 6.25 3H17.75C19.5449 3 21 4.45507 21 6.25V17.75C21 19.5449 19.5449 21 17.75 21H6.25C4.45507 21 3 19.5449 3 17.75V6.25ZM6.25 4.5C5.2835 4.5 4.5 5.2835 4.5 6.25V17.75C4.5 18.7165 5.2835 19.5 6.25 19.5H17.75C18.7165 19.5 19.5 18.7165 19.5 17.75V6.25C19.5 5.2835 18.7165 4.5 17.75 4.5H6.25Z</StreamGeometry>

    </Window.Resources>

    <Design.DataContext>
        <!--
            This only sets the DataContext for the previewer in an IDE,
            to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs)
        -->
        <vm:MainWindowViewModel />
    </Design.DataContext>

    <Grid ShowGridLines="True">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250" />
            <ColumnDefinition Width="0.65*" MinWidth="300" />
            <ColumnDefinition Width="0.35*" MinWidth="200" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock
            Grid.Row="0"
            Margin="5"
            VerticalAlignment="Bottom"
            FontSize="14"
            Text="{CompiledBinding ConnectionStatus}" />

        <ScottPlot:AvaPlot
            x:Name="AvaPlot1"
            Grid.Row="0"
            Grid.Column="1"
            Margin="0,0,0,0" />

        <TextBlock
            Grid.Row="0"
            Grid.Column="1"
            Margin="5"
            HorizontalAlignment="Left"
            VerticalAlignment="Bottom"
            FontSize="14"
            Text="{CompiledBinding DataFlowStatus}" />

        <ToggleSwitch
            Grid.Row="0"
            Grid.Column="1"
            Margin="0,10,10,0"
            HorizontalAlignment="Right"
            VerticalAlignment="Top"
            Content="Реальное время"
            IsChecked="{CompiledBinding IsRealtimeMode,
                                        Mode=TwoWay}"
            IsEnabled="{CompiledBinding !IsDiagramAcquisitionRunning}"
            OffContent="Выкл"
            OnContent="Вкл"
            ZIndex="2" />



        <StackPanel
            Grid.Row="0"
            Grid.Column="1"
            Margin="10,10,0,0"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Orientation="Vertical"
            ZIndex="1">
            <TextBlock
                Margin="0,0,10,0"
                VerticalAlignment="Center"
                Text="Тип графика:" />
            <RadioButton
                Margin="0,0,10,0"
                Content="дБ"
                GroupName="GraphType"
                IsChecked="{CompiledBinding IsPowerNormSelected,
                                            Mode=TwoWay}"
                IsEnabled="{CompiledBinding !IsDiagramAcquisitionRunning}" />
            <RadioButton
                Content="Линейный"
                GroupName="GraphType"
                IsChecked="{x:Null}"
                IsEnabled="{CompiledBinding !IsDiagramAcquisitionRunning}" />
        </StackPanel>

        <Grid Grid.Row="0" Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="0.33*" />
                <RowDefinition Height="0.33*" />
                <RowDefinition Height="0.33*" />
            </Grid.RowDefinitions>

            <!--  Верхний ряд - Передающая антенна  -->
            <StackPanel
                Grid.Row="0"
                Margin="10"
                VerticalAlignment="Center">
                <TextBlock
                    Margin="0,0,0,5"
                    FontWeight="Bold"
                    Text="Передающая антенна" />
                <StackPanel Margin="0,0,0,5" Orientation="Horizontal">
                    <TextBlock
                        Margin="0,0,5,0"
                        VerticalAlignment="Center"
                        Text="Угол:" />
                    <NumericUpDown
                        Width="125"
                        FormatString="0.0"
                        Increment="1"
                        KeyDown="NumericUpDown_KeyDown"
                        Maximum="359"
                        Minimum="0"
                        Watermark="0-359"
                        Value="{CompiledBinding TransmitterMoveAngle,
                                                Mode=TwoWay}" />
                </StackPanel>
                <TextBlock
                    FontSize="12"
                    Foreground="Red"
                    Text="{CompiledBinding TransmitterMoveAngleError}" />
                <Button
                    Width="100"
                    Margin="0,0,0,10"
                    HorizontalAlignment="Left"
                    Command="{CompiledBinding MoveTransmitterToAngleCommand}"
                    Content="Переместить в"
                    IsEnabled="{CompiledBinding CanUseWhenPortOpen}" />

                <StackPanel Margin="0,0,0,5" Orientation="Horizontal">
                    <TextBlock
                        Margin="0,0,5,0"
                        VerticalAlignment="Center"
                        Text="Угол:" />
                    <NumericUpDown
                        Width="125"
                        FormatString="0.0"
                        Increment="1"
                        KeyDown="NumericUpDown_KeyDown"
                        Maximum="359"
                        Minimum="0"
                        Watermark="0-359"
                        Value="{CompiledBinding TransmitterSetAngle,
                                                Mode=TwoWay,
                                                FallbackValue=0}" />
                </StackPanel>
                <TextBlock
                    FontSize="12"
                    Foreground="Red"
                    Text="{CompiledBinding TransmitterSetAngleError}" />
                <Button
                    Width="100"
                    HorizontalAlignment="Left"
                    Command="{CompiledBinding SetTransmitterAngleCommand}"
                    Content="Задать"
                    IsEnabled="{CompiledBinding CanUseWhenPortOpen}" />
            </StackPanel>

            <!--  Средний ряд - Существующие текстовые блоки  -->
            <StackPanel Grid.Row="1" VerticalAlignment="Center">
                <TextBlock Text="Receiver Angle:" />
                <TextBlock Margin="2" Text="{CompiledBinding ReceiverAngleDegStr}" />

                <TextBlock Text="Transmitter Angle:" />
                <TextBlock Margin="2" Text="{CompiledBinding TransmitterAngleDegStr}" />

                <TextBlock Text="Power (dBm):" />
                <TextBlock Margin="2" Text="{CompiledBinding PowerDbmStr}" />

                <TextBlock Text="Antenna Type:" />
                <TextBlock Margin="2" Text="{CompiledBinding AntennaTypeStr}" />

                <TextBlock Text="Rx Antenna Counter:" />
                <TextBlock Margin="2" Text="{CompiledBinding RxAntennaCounterStr}" />

                <ToggleSwitch
                    Margin="10,0,0,0"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Content="Тёмная тема"
                    IsChecked="{CompiledBinding IsDarkTheme,
                                                Mode=TwoWay}" />
            </StackPanel>

            <!--  Нижний ряд - Приемная антенна  -->
            <StackPanel Grid.Row="2" VerticalAlignment="Center">
                <TextBlock
                    Margin="0,0,0,5"
                    FontWeight="Bold"
                    Text="Приемная антенна" />
                <StackPanel Margin="0,0,0,5" Orientation="Horizontal">
                    <TextBlock
                        Margin="0,0,5,0"
                        VerticalAlignment="Center"
                        Text="Угол:" />
                    <NumericUpDown
                        Width="125"
                        FormatString="0.0"
                        Increment="1"
                        KeyDown="NumericUpDown_KeyDown"
                        Maximum="359"
                        Minimum="0"
                        Watermark="0-359"
                        Value="{CompiledBinding ReceiverMoveAngle,
                                                Mode=TwoWay}" />
                </StackPanel>
                <TextBlock
                    FontSize="12"
                    Foreground="Red"
                    Text="{CompiledBinding ReceiverMoveAngleError}" />
                <Button
                    Width="100"
                    Margin="0,0,0,10"
                    HorizontalAlignment="Left"
                    Command="{CompiledBinding MoveReceiverToAngleCommand}"
                    Content="Переместить в"
                    IsEnabled="{CompiledBinding CanUseWhenPortOpen}" />

                <StackPanel Margin="0,0,0,5" Orientation="Horizontal">
                    <TextBlock
                        Margin="0,0,5,0"
                        VerticalAlignment="Center"
                        Text="Угол:" />
                    <NumericUpDown
                        Width="125"
                        FormatString="0.0"
                        Increment="1"
                        KeyDown="NumericUpDown_KeyDown"
                        Maximum="359"
                        Minimum="0"
                        Watermark="0-359"
                        Value="{CompiledBinding ReceiverSetAngle,
                                                Mode=TwoWay,
                                                FallbackValue=0}" />
                </StackPanel>
                <TextBlock
                    FontSize="12"
                    Foreground="Red"
                    Text="{CompiledBinding ReceiverSetAngleError}" />
                <Button
                    Width="100"
                    HorizontalAlignment="Left"
                    Command="{CompiledBinding SetReceiverAngleCommand}"
                    Content="Задать"
                    IsEnabled="{CompiledBinding CanUseWhenPortOpen}" />
            </StackPanel>

        </Grid>

        <Grid
            Grid.Row="0"
            Grid.Column="3"
            Margin="5"
            ShowGridLines="True">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="200" />
            </Grid.RowDefinitions>

            <StackPanel
                Grid.Row="0"
                Margin="0,0,0,8"
                HorizontalAlignment="Left"
                Orientation="Horizontal">
                <Button
                    Margin="5"
                    Command="{CompiledBinding AddTabCommand}"
                    Content="Добавить"
                    IsEnabled="{CompiledBinding CanUseWhenPortOpen}">
                    <PathIcon Data="{StaticResource add_square_regular}" />
                </Button>

                <Button
                    Margin="5"
                    Command="{CompiledBinding RemoveTabCommand}"
                    Content="Удалить"
                    IsEnabled="{CompiledBinding CanRemoveTabWhenPortOpen}">
                    <PathIcon Data="{StaticResource delete_forever_regular}" />
                </Button>
                <Button
                    Margin="5"
                    Command="{CompiledBinding ClearTableCommand}"
                    Content="Очистить"
                    IsEnabled="{CompiledBinding CanUseWhenPortOpen}">
                    <PathIcon Data="{StaticResource erase_regular}" />
                </Button>
                <Button
                    x:Name="ImportButton"
                    Margin="5"
                    Content="Загрузить"
                    IsEnabled="{CompiledBinding CanUseWhenHasTabs}"
                    Click="ImportButton_Click">
                    <PathIcon Data="{StaticResource folder_open_regular}" />
                </Button>
                <Button
                    x:Name="ExportButton"
                    Margin="5"
                    IsEnabled="{CompiledBinding CanUseWhenHasTabs}">
                    <PathIcon Data="{StaticResource save_as_regular}" />
                </Button>
                <Button
                    x:Name="TogglePlotVisibilityButton"
                    Margin="5"
                    Click="TogglePlotVisibility_Click"
                    IsEnabled="{CompiledBinding CanUseWhenHasTabs}">
                    <Button.Content>
                        <Grid>
                            <PathIcon Data="{StaticResource eye_show_regular}" IsVisible="{CompiledBinding SelectedTab.Plot.IsVisible}" />
                            <PathIcon Data="{StaticResource eye_hide_regular}" IsVisible="{CompiledBinding !SelectedTab.Plot.IsVisible}" />
                        </Grid>
                    </Button.Content>
                </Button>
                <ColorPicker
                    Width="70"
                    Height="32"
                    Margin="5"
                    Color="{Binding SelectedTab.Plot.ColorHex, Mode=TwoWay, Converter={StaticResource HexToColorConverter}}" />

            </StackPanel>
            <TabControl
                Grid.Row="1"
                IsEnabled="{CompiledBinding !IsDiagramAcquisitionRunning}"
                ItemsSource="{CompiledBinding Tabs}"
                SelectedIndex="{CompiledBinding SelectedTabIndex}">
                <TabControl.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBox
                                MinWidth="100"
                                IsVisible="{CompiledBinding IsEditingHeader}"
                                KeyDown="HeaderEdit_KeyDown"
                                LostFocus="HeaderEdit_LostFocus"
                                Text="{CompiledBinding Header,
                                                       Mode=TwoWay}" />
                            <TextBlock
                                MinWidth="100"
                                DoubleTapped="Header_DoubleTapped"
                                IsVisible="{CompiledBinding !IsEditingHeader}}"
                                Text="{CompiledBinding Header}" />
                        </StackPanel>
                    </DataTemplate>
                </TabControl.ItemTemplate>

                <TabControl.ContentTemplate>
                    <DataTemplate DataType="{x:Type vm:TabViewModel}">
                        <treegrid:TreeDataGrid
                            MinHeight="100"
                            Margin="0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Top"
                            Source="{Binding AntennaSource}" />
                    </DataTemplate>
                </TabControl.ContentTemplate>
            </TabControl>

            <Grid
                Grid.Row="2"
                Margin="0,8,0,0"
                ShowGridLines="True">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="55" />
                    <ColumnDefinition Width="130" />
                    <ColumnDefinition Width="80" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!--  Размер сектора  -->
                <TextBlock
                    Grid.Row="0"
                    Grid.Column="0"
                    Margin="0,0,4,0"
                    VerticalAlignment="Center"
                    Text="Размер:" />
                <NumericUpDown
                    Name="NumericUpDownSectorSize"
                    Grid.Row="0"
                    Grid.Column="1"
                    Width="115"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    Increment="5"
                    IsEnabled="{CompiledBinding !IsDiagramAcquisitionRunning}"
                    LostFocus="NumericUpDown_LostFocus"
                    Maximum="360"
                    Minimum="10"
                    Watermark="Размер сектора"
                    Value="{CompiledBinding SectorSize,
                                            Mode=TwoWay}" />

                <!--  Центр сектора  -->
                <TextBlock
                    Grid.Row="1"
                    Grid.Column="0"
                    Margin="0,0,4,0"
                    VerticalAlignment="Center"
                    Text="Центр:" />
                <NumericUpDown
                    Name="NumericUpDownSectorCenter"
                    Grid.Row="1"
                    Grid.Column="1"
                    Width="115"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    Increment="5"
                    IsEnabled="{CompiledBinding !IsDiagramAcquisitionRunning}"
                    KeyDown="NumericUpDown_KeyDown"
                    LostFocus="NumericUpDown_LostFocus"
                    Maximum="360"
                    Minimum="-1"
                    Watermark="Центр сектора"
                    Value="{CompiledBinding SectorCenter,
                                            Mode=TwoWay}" />

                <StackPanel
                    Grid.Row="0"
                    Grid.RowSpan="2"
                    Grid.Column="2"
                    Margin="8,4,0,0"
                    VerticalAlignment="Center"
                    Orientation="Vertical">
                    <Button
                        Width="60"
                        Height="28"
                        Margin="0,0,0,6"
                        Command="{CompiledBinding Set120DegreesCommand}"
                        Content="120°" />
                    <Button
                        Width="60"
                        Height="28"
                        Margin="0,0,0,6"
                        Command="{CompiledBinding Set180DegreesCommand}"
                        Content="180°" />
                    <Button
                        Width="60"
                        Height="28"
                        Margin="0,0,0,6"
                        Command="{CompiledBinding Set360DegreesCommand}"
                        Content="360°" />
                </StackPanel>
                <StackPanel
                    Grid.Row="0"
                    Grid.RowSpan="2"
                    Grid.Column="3"
                    Margin="0,8,0,0"
                    VerticalAlignment="Top"
                    Orientation="Vertical">
                    <CheckBox
                        MinWidth="130"
                        Margin="0,0,8,0"
                        Content="отображать антенну"
                        IsChecked="{CompiledBinding ShowAntenna,
                                                    Mode=TwoWay}" />
                    <CheckBox
                        MinWidth="130"
                        Content="отображать сектор"
                        IsChecked="{CompiledBinding ShowSector,
                                                    Mode=TwoWay}" />
                </StackPanel>

                <!--  Кнопки построения и прерывания диаграммы  -->
                <Button
                    x:Name="StartButton"
                    Grid.Row="2"
                    Grid.Column="0"
                    Grid.ColumnSpan="3"
                    Height="32"
                    Margin="0,8,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Bottom"
                    Command="{CompiledBinding StartDiagramAcquisitionCommand}"
                    Content="Начать построение диаграммы"
                    IsEnabled="{CompiledBinding IsPortOpen}"
                    IsVisible="{CompiledBinding !IsDiagramAcquisitionRunning}">
                    <Button.Styles>
                        <Style>
                            <Style.Resources>
                                <SolidColorBrush x:Key="ThemeBorderMidBrush">LimeGreen</SolidColorBrush>
                                <SolidColorBrush x:Key="ThemeControlHighBrush">LightGreen</SolidColorBrush>
                                <SolidColorBrush x:Key="ButtonBorderBrush">LimeGreen</SolidColorBrush>
                                <SolidColorBrush x:Key="ButtonBackground">LimeGreen</SolidColorBrush>
                                <SolidColorBrush x:Key="ButtonBackgroundPointerOver">Lime</SolidColorBrush>
                                <SolidColorBrush x:Key="ButtonBackgroundPressed">LightGreen</SolidColorBrush>
                            </Style.Resources>
                        </Style>
                    </Button.Styles>
                </Button>
                <Button
                    x:Name="StopButton"
                    Grid.Row="2"
                    Grid.Column="0"
                    Grid.ColumnSpan="3"
                    Height="32"
                    Margin="0,8,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Bottom"
                    Command="{CompiledBinding CancelDiagramAcquisitionCommand}"
                    Content="              Прервать             "
                    IsEnabled="{CompiledBinding IsPortOpen}"
                    IsVisible="{CompiledBinding IsDiagramAcquisitionRunning}">
                    <Button.Styles>
                        <Style>
                            <Style.Resources>
                                <SolidColorBrush x:Key="ThemeBorderMidBrush">Red</SolidColorBrush>
                                <SolidColorBrush x:Key="ThemeControlHighBrush">DarkRed</SolidColorBrush>
                                <SolidColorBrush x:Key="ButtonBorderBrush">Red</SolidColorBrush>
                                <SolidColorBrush x:Key="ButtonBackground">OrangeRed</SolidColorBrush>
                                <SolidColorBrush x:Key="ButtonBackgroundPointerOver">Red</SolidColorBrush>
                                <SolidColorBrush x:Key="ButtonBackgroundPressed">OrangeRed</SolidColorBrush>
                            </Style.Resources>
                        </Style>
                    </Button.Styles>
                </Button>

            </Grid>

        </Grid>
    </Grid>

</Window>
